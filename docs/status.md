# 專案狀態追蹤

## 里程碑與任務
- [x] 專案初始化：模組設定、依賴管理完成。
- [x] 基礎儲存模組：`internal/storage` 實作 XDG 目錄管理。
- [x] 主程式入口：建立 `cmd/ora` 目錄與簡單 CLI。
- [x] 單元測試：為 `internal/storage` 撰寫測試（覆蓋率 89.7% ≥80%）。
- [x] 重構 main 函式為可測試結構：提取邏輯、添加測試 (暫停介面注入依賴)。
- [ ] MVP 驗證：基本功能測試與建置確認。

## 近期任務
- 重構 main 函式：將目錄獲取邏輯提取至獨立函式，便於測試 (暫停介面抽象 storage 依賴)。
- 撰寫單元測試：為重構後的 main 相關函式添加測試 (目前覆蓋率 41.7%，暫停進一步提升)。
- [x] 執行建置與測試驗證：確認重構後程式正常運作。
- [x] 修改筆記儲存邏輯：移除標題清澤，改為檢查非法字元並返回錯誤；更新呼召者處理錯誤；調整測試。
- [x] 修復測試錯誤訊息：調整 `internal/storage` 測試以修復錯誤，覆蓋率提升至 89.7%。
- [x] 重構測試模擬：修改 `internal/storage` 以使用 mockGetDataDir 變數，避免 LSP 錯誤並改善測試隔離性。
- [x] 進一步重構測試模擬：移除函數變數，改用 `testDataHome` 和 `testError` 變數以避免 LSP 錯誤。

- [x] 修復 TestSaveNote_GetDataDirError：添加 testError 設定以正確模擬錯誤。

## 風險與備註
- 重構風險低：變更聚焦單一函式，易回滾。
- 需維持小步提交，避免破壞性變更。
- 測試優先：重構後立即添加測試以符合 TDD 方針。
- 儲存邏輯變更已實作，風險中：檔案名稱可能包含空格，但錯誤處理已改善；影響 CLI 互動流程。